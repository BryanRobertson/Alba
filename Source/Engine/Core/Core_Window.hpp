#pragma once

#include "Core.hpp"
#include "Core_AnyDictionary.hpp"
#include "Core_UniquePtr.hpp"
#include "Core_FixedString.hpp"
#include "Math_Vector.hpp"

//-------------------------------------------------------------------------------------------------
// Name	:	Core_Window.hpp
// Desc	:	Wraps an operating system window on the relevant platform
//-------------------------------------------------------------------------------------------------

namespace Alba
{
	namespace Core
	{
		struct WindowImpl;
		struct WindowEventHandler;

		//-----------------------------------------------------------------------------------------
		// Name	:	WindowInitParams
		//-----------------------------------------------------------------------------------------
		struct WindowInitParams
		{
			int32			 myPositionX = 100;
			int32			 myPositionY = 100;
			int32			 mySizeX	 = 800;
			int32			 mySizeY	 = 600;
			FixedString<32>	 myTitle	= "Alba";
			bool			 myIsHidden = false;
			bool			 myIsResizable = false;
		};

		//-----------------------------------------------------------------------------------------
		// Name	:	Window
		//-----------------------------------------------------------------------------------------
		class Window final
		{
			public:

				//=================================================================================
				// Public Static Methods
				//=================================================================================
				static UniquePtr<Window> Create();

				//=================================================================================
				// Public Destructors
				//=================================================================================
				~Window();

				//=================================================================================
				// Public Methods
				//=================================================================================
	
				//---------------------------------------------------------------------------------
				// Initialise
				//---------------------------------------------------------------------------------
				bool				Init(const WindowInitParams& aParams);

				//---------------------------------------------------------------------------------
				// Update
				//---------------------------------------------------------------------------------
				bool				Update();

				//---------------------------------------------------------------------------------
				// Window properties
				//---------------------------------------------------------------------------------
				void				SetTitleText(const char* aStr);
				FixedString<32>		GetTitleText() const;

				//---------------------------------------------------------------------------------
				// Event handler
				//---------------------------------------------------------------------------------
				void				SetEventHandler(const WindowEventHandler& aHandler);

				void				SetInputHandler(const WindowEventHandler& aHandler);
				const WindowEventHandler& GetInputHandler() const;

				//---------------------------------------------------------------------------------
				// Platform-specific data
				//---------------------------------------------------------------------------------
				inline const AnyDictionary& GetPlatformData() const;

			private:

				//=================================================================================
				// Private Constructors
				//=================================================================================
				Window();

				//=================================================================================
				// Private Methods
				//=================================================================================
				void					Destroy();

				//=================================================================================
				// Private Data
				//=================================================================================

				// Holds platform-specific data for the window
				AnyDictionary			myPlatformData;

				// Implementation
				UniquePtr<WindowImpl>	myImpl;
		};

		//-----------------------------------------------------------------------------------------
		//-----------------------------------------------------------------------------------------
		inline const AnyDictionary& Window::GetPlatformData() const
		{
			return myPlatformData;
		}
	}
}